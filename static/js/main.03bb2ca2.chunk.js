(this["webpackJsonpbacklog-app"]=this["webpackJsonpbacklog-app"]||[]).push([[0],{139:function(e,t,n){e.exports={container:"styles_container__1h2a_",right_space:"styles_right_space__1-9Il"}},142:function(e,t,n){e.exports={allowedToDrop:"styles_allowedToDrop__1HdZ6",droppableArea:"styles_droppableArea__1y-Wm"}},148:function(e,t,n){e.exports={buttons:"styles_buttons__2uFU4",placeholder:"styles_placeholder__1IF_b"}},162:function(e,t,n){e.exports={container:"App_container__eSJ6i"}},191:function(e,t,n){},210:function(e,t,n){"use strict";n.r(t);var r=n(2),o=n(0),i=n.n(o),a=n(33),s=n.n(a),c=(n(191),n(162)),l=n.n(c),u=(n(192),n(139)),d=n.n(u),p=n(35),b=n(42),j=n.n(b),f=n(11),v=n(29);function O(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}function m(e){var t=Object.keys(e).map((function(e){return Number.parseInt(e)})).filter((function(e){return!Number.isNaN(e)}));return t[Math.floor(Math.random()*t.length)]}var g,h,x=n(100),y=n.n(x);!function(e){e[e.HIGH=0]="HIGH",e[e.MEDIUM=1]="MEDIUM",e[e.LOW=2]="LOW"}(g||(g={})),function(e){e[e.HIGH=0]="HIGH",e[e.MEDIUM=1]="MEDIUM",e[e.LOW=2]="LOW"}(h||(h={}));var _=function(e){return Object.keys(e).filter((function(t){return!y.a.isNumber(e[t])})).map((function(t){return{key:t,value:t,text:e[t]}}))},w=function(){var e=Object(v.v4)();return{id:e,priority:m(h),risk:m(g),name:e,points:O(1,5),description:e,dependencies:[]}},D=n(46),S=n.n(D),k=n(78),C=function(e){switch(e){case g.HIGH:return S.a.high;case g.MEDIUM:return S.a.medium;case g.LOW:return S.a.low;default:return""}},I=function(e){var t=e.story,n=t.id,o=t.name,i=t.points,a=t.priority,s=t.risk,c=e.index,l=e.setEditing;return Object(r.jsx)(k.b,{draggableId:n,index:c,children:function(e){return Object(r.jsxs)("div",Object(f.a)(Object(f.a)(Object(f.a)({},e.draggableProps),e.dragHandleProps),{},{ref:e.innerRef,className:"".concat(S.a.container," ").concat(C(s)),onClick:l,children:[Object(r.jsx)("div",{className:S.a.points_container,children:Object(r.jsx)("div",{className:S.a.points,children:i})}),Object(r.jsx)("div",{className:S.a.name,children:o}),Object(r.jsx)("div",{className:S.a.priority,children:"Priority: ".concat(g[a])})]}))}})},N=n(142),E=n.n(N),T=n(12),M=n(80),R=n(169);var F={backlog:[],sprints:[{stories:[],maxPoints:20,name:"Sprint 1",id:Object(v.v4)(),allowedToDrop:!0}],currentlyDragged:!1},P=function(e,t){var n;if(t.droppableId===H)n=e.backlog[t.index];else{var r=e.sprints.find((function(e){return e.id===t.droppableId}));n=null===r||void 0===r?void 0:r.stories[t.index]}return n};function A(e,t,n){if(e.droppableId===H)t.backlog=t.backlog.filter((function(e){return e.id!==n}));else{var r=t.sprints.find((function(t){return t.id===e.droppableId}));r&&(r.stories=r.stories.filter((function(e){return e.id!==n})))}}var q=Object(M.b)({name:"planner",initialState:F,reducers:{moveCard:function(e,t){var n=t.payload,r=n.draggableId,o=n.source,i=n.destination;if(e.sprints.forEach((function(e){return e.allowedToDrop=!0})),i){var a=P(e,o);if(a)if(A(o,e,r),i.droppableId===H)e.backlog.splice(i.index,0,a);else{var s=e.sprints.find((function(e){return e.id===i.droppableId}));null===s||void 0===s||s.stories.splice(i.index,0,a)}}},updateDroppables:function(e,t){var n=t.payload.source,r=P(e,n);r&&e.sprints.forEach((function(e){if(e.id!==n.droppableId){var t=be(e.stories);e.allowedToDrop=e.maxPoints>=t+r.points}}))},setIsDragged:function(e,t){var n=t.payload;e.currentlyDragged=n},saveSprint:function(e,t){var n=t.payload;if(n.id){var r=e.sprints.findIndex((function(e){return e.id===n.id}));e.sprints[r]=n}else e.sprints.push(Object(f.a)(Object(f.a)({},n),{},{id:Object(v.v4)(),stories:[]}))},saveStory:function(e,t){var n=t.payload,r=n.content,o=n.source;if(o)if(o.droppableId===H)e.backlog[o.index]=r;else{var i=e.sprints.find((function(e){return e.id===o.droppableId}));if(!i)return;i.stories[o.index]=r}else e.backlog.splice(0,0,Object(f.a)(Object(f.a)({},r),{},{id:Object(v.v4)()}))},removeSprint:function(e,t){var n=t.payload;0===n.stories.length&&(e.sprints=e.sprints.filter((function(e){return e.id!==n.id})))},removeStory:function(e,t){var n=t.payload,r=n.source,o=n.content;r&&A(r,e,o.id)},importState:function(e,t){var n=t.payload;e.backlog=n.backlog,e.sprints=n.sprints},importStories:function(e,t){var n,r=t.payload;(n=e.backlog).push.apply(n,Object(R.a)(r))},createRandomStory:function(e){e.backlog.push(w())},createRandomSprint:function(e){e.sprints.push(function(){var e=Object(v.v4)();return{id:e,name:e,maxPoints:20,stories:y.a.times(O(1,4)).map((function(){return w()})),allowedToDrop:!0}}())}}}),H="Backlog",L=q.actions,U=L.moveCard,W=L.updateDroppables,B=L.setIsDragged,J=L.saveSprint,G=L.saveStory,z=L.removeStory,Q=L.removeSprint,V=L.importState,Z=L.importStories,Y=(L.createRandomSprint,L.createRandomStory,function(e){return e.planner.backlog}),$=function(e){return e.planner.sprints},K=function(e){return e.planner.currentlyDragged},X=q.reducer,ee={sprint:void 0,story:void 0},te=Object(M.b)({name:"editing",initialState:ee,reducers:{setEditingSprint:function(e,t){var n=t.payload;e.sprint=n},setEditingStory:function(e,t){var n=t.payload;e.story=n}},extraReducers:function(e){e.addCase(J,(function(e){return e.sprint=void 0})).addCase(G,(function(e){return e.story=void 0})).addCase(z,(function(e){return e.story=void 0})).addCase(Q,(function(e){return e.sprint=void 0}))}}),ne=te.actions,re=ne.setEditingSprint,oe=ne.setEditingStory,ie=function(e){return e.editing},ae=function(e){return ie(e).sprint},se=function(e){return ie(e).story},ce=te.reducer,le=function(e){var t=e.droppableProps,n=e.className,o=e.stories,i=Object(T.useDispatch)();return Object(r.jsx)(k.c,Object(f.a)(Object(f.a)({},t),{},{children:function(e,a){return Object(r.jsxs)("div",Object(f.a)(Object(f.a)({className:"".concat(n," ").concat(E.a.droppableArea," ").concat(a.draggingOverWith?E.a.allowedToDrop:""),ref:e.innerRef},e.droppableProps),{},{children:[o.map((function(e,n){return Object(r.jsx)(I,{story:e,index:n,setEditing:function(){return i(oe({source:{droppableId:t.droppableId,index:n},content:e}))}},e.id)})),e.placeholder]}))}}))},ue=n(173),de=n(164),pe=n.n(de);function be(e){return 0!==e.length?e.map((function(e){return e.points})).reduce((function(e,t){return e+t})):0}var je=function(e){var t=e.sprint,n=t.id,i=t.name,a=t.stories,s=t.maxPoints,c=t.allowedToDrop,l=e.isDragging,u=e.setEditing,d=be(a),b=Object(o.useState)(!1),f=Object(p.a)(b,2),v=f[0],O=f[1];return Object(o.useEffect)((function(){O(s<d)}),[s,d]),Object(r.jsxs)("div",{className:"".concat(j.a.container," ").concat(v?j.a.container_overflowed:""),children:[Object(r.jsxs)("div",{className:j.a.header,children:[Object(r.jsx)("div",{className:j.a.title,children:i}),Object(r.jsx)(ue.a,{onClick:u,icon:"pencil",compact:!0}),Object(r.jsxs)("div",{className:"".concat(j.a.capacity," ").concat(v?j.a.capacity_overflowed:""),children:[Object(r.jsx)(pe.a,{value:d,formatValue:function(e){return e.toFixed(0)},duration:60}),"\xa0","/ ".concat(s)]})]}),Object(r.jsx)(le,{droppableProps:{droppableId:n,isDropDisabled:!c},className:"".concat(j.a.stories_droppable," ").concat(l?c?j.a.allowedToDrop:j.a.notAllowedToDrop:""),stories:a})]})},fe=function(e){var t=e.sprints,n=e.isDragging,o=Object(T.useDispatch)();return Object(r.jsxs)("div",{className:d.a.container,children:[t.map((function(e){return Object(r.jsx)(je,{sprint:e,isDragging:n,setEditing:function(){return o(re(e))}},e.id)})),Object(r.jsx)("div",{className:d.a.right_space})]})},ve=n(230),Oe=n(147),me=n(146),ge=n(36),he=n.n(ge),xe=Object(M.a)({reducer:{toastr:ge.reducer,planner:X,editing:ce}}),ye=function(e){var t=new Blob([e],{type:"text/plain"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.setAttribute("download","save.json"),r.href=n,document.body.appendChild(r),window.requestAnimationFrame((function(){var e=new MouseEvent("click");r.dispatchEvent(e),document.body.removeChild(r),window.URL.revokeObjectURL(n)}))},_e=n(130),we=n(145),De=function(e){var t=e.uniqueId,n=e.importText,i=e.onFileRead,a=e.successText,s=e.extension,c=Object(o.useState)(!1),l=Object(p.a)(c,2),u=l[0],d=l[1],b=Object(o.useRef)(null),j=Object(o.useState)((function(){var e=new FileReader;return e.onloadstart=function(){d(!0)},e.onloadend=function(){return d(!1)},e.onload=function(e){if(console.log("onload",e),e.target&&"string"===typeof e.target.result)try{i(e.target.result),ge.toastr.success(a,"Application should now update")}catch(t){ge.toastr.error("Can't parse the file",null===t||void 0===t?void 0:t.message),console.error(t)}else ge.toastr.error("Can't read the file","Type of the result is not string")},e})),f=Object(p.a)(j,1)[0];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("input",{ref:b,id:t,type:"file",onChange:function(e){var t=e.target.files;t&&0!==t.length&&(t.length>1?ge.toastr.error("Can't select file","Multiple files upload is not supported"):(f.readAsText(t[0]),e.target.value=null))},style:{display:"none"},accept:s}),Object(r.jsx)(_e.a,{open:u,size:"mini",children:Object(r.jsx)(we.a,{children:n})})]})},Se=n(166),ke=n.n(Se);function Ce(e){var t=document.getElementById(e);t&&t.click()}var Ie=function(e,t){return Object(f.a)(Object(f.a)({},e),{},{id:Ne(e.id,t),points:+e.points,risk:g[e.risk],priority:h[e.priority],dependencies:e.dependencies.replace(" ","").split(",").map((function(e){return Ne(e,t)}))})},Ne=function(e,t){var n=t[e];return void 0===n&&(t[e]=Object(v.v4)(),n=t[e],console.log("unknown id, created new",e,n)),n},Ee=Object(v.v4)(),Te=Object(v.v4)(),Me=function(){var e=Object(T.useDispatch)(),t=Object(o.useCallback)((function(t){return e(V(JSON.parse(t)))}),[e]),n=Object(o.useCallback)((function(t){return e(Z(function(e){var t=ke.a.parse(e,{header:!0});if(t.errors.length>0){var n="Can't parse the csv";throw ge.toastr.error(n,"".concat(t.errors.length," errors in console")),console.error(n,t.errors),Error(n)}var r={},o=t.data.map((function(e){return Ie(e,r)}));return console.log("stories",o),o}(t)))}),[e]);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(De,{uniqueId:Ee,importText:"Importing state...",successText:"State imported!",onFileRead:t,extension:".json"}),Object(r.jsx)(De,{uniqueId:Te,importText:"Importing stories...",successText:"Stories imported!",onFileRead:n,extension:".csv"}),Object(r.jsx)(ve.a,{icon:"file",text:"Storage...",floating:!0,labeled:!0,button:!0,className:"icon button teal",children:Object(r.jsxs)(Oe.a,{children:[Object(r.jsx)(me.a,{onClick:function(){return Ce(Ee)},children:"Import state..."}),Object(r.jsx)(me.a,{onClick:function(){return function(){var e=xe.getState().planner,t={backlog:e.backlog,sprints:e.sprints};ye(JSON.stringify(t)),window.onbeforeunload=null}()},children:"Export state..."}),Object(r.jsx)(me.a,{onClick:function(){return Ce(Te)},children:"Import stories..."})]})})]})},Re=function(){var e=Object(T.useDispatch)();return Object(r.jsx)(ve.a,{text:"Create...",icon:"plus",button:!0,floating:!0,labeled:!0,className:"icon button teal",children:Object(r.jsxs)(Oe.a,{children:[Object(r.jsx)(me.a,{onClick:function(){return e(oe({}))},children:"User story..."}),Object(r.jsx)(me.a,{onClick:function(){return e(re({}))},children:"Sprint..."})]})})},Fe=n(95),Pe=n.n(Fe),Ae=function(e){var t=e.stories,n=e.isDragging;return Object(r.jsxs)("div",{className:Pe.a.container,children:[Object(r.jsxs)("div",{className:Pe.a.menus,children:[Object(r.jsx)(Re,{}),Object(r.jsx)(Me,{})]}),!1,Object(r.jsx)(le,{droppableProps:{droppableId:H},className:"".concat(Pe.a.stories_droppable," ").concat(n?Pe.a.availableToDrop:""),stories:t})]})},qe=function(e){var t=e.sprints,n=e.stories;return Object(o.useEffect)((function(){window.onbeforeunload=function(){return"There are unsaved changes!"}}),[t,n]),null},He=n(170),Le=n(172),Ue=n(167),We=n(171),Be=n(228),Je=n(144),Ge=n(232),ze=n(229),Qe=n(148),Ve=n.n(Qe);var Ze=function(e){var t=e.editMode,n=e.entity,i=e.entityName,a=e.onClose,s=e.remove,c=e.save,l=e.formControls,u=e.removeDisabled,d=Object(o.useState)(),b=Object(p.a)(d,2),j=b[0],f=b[1];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Be.a,{size:"mini",content:"Are you sure you want to delete ".concat(i,"?"),open:j,onConfirm:function(){s&&s(),f(!1)},onCancel:function(){return f(!1)}}),Object(r.jsxs)(_e.a,{open:void 0!==n,onClose:a,size:"tiny",children:[Object(r.jsx)(Je.a,{children:"".concat(t?"Edit":"Create"," ").concat(i)}),Object(r.jsx)(we.a,{children:n&&Object(r.jsxs)(Ge.a,{onSubmit:c,children:[l,Object(r.jsxs)("div",{className:Ve.a.buttons,children:[Object(r.jsx)(ue.a,{type:"submit",color:"green",content:"Save"}),Object(r.jsx)("div",{className:Ve.a.placeholder}),t&&Object(r.jsx)(ze.a,{trigger:Object(r.jsx)("div",{children:Object(r.jsx)(ue.a,{type:"push",onClick:function(e){e.preventDefault(),f(!0)},color:"red",icon:"trash alternate",disabled:void 0!==u})}),disabled:void 0===u,content:u})]})]})})]})]})},Ye=function(e){var t,n,i=e.editingData,a=e.save,s=e.onClose,c=e.remove,l=void 0!==(null===i||void 0===i?void 0:i.source),u=Object(o.useState)(),d=Object(p.a)(u,2),b=d[0],j=d[1];return Object(o.useEffect)((function(){i&&j(i.content)}),[i]),Object(r.jsx)(Ze,{entityName:"story",onClose:s,remove:c,editMode:l,save:function(){return a(Object(f.a)(Object(f.a)({},i),{},{content:b}))},entity:i,formControls:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(He.a,{value:(null===b||void 0===b?void 0:b.name)||"",label:"Name",required:!0,autoFocus:!0,onChange:function(e,t){var n=t.value;return j((function(e){return Object(f.a)(Object(f.a)({},e),{},{name:n})}))}}),Object(r.jsx)(Le.a,{value:(null===b||void 0===b?void 0:b.description)||"",label:"Description",onChange:function(e,t){var n=t.value;return j((function(e){return Object(f.a)(Object(f.a)({},e),{},{description:n})}))}}),Object(r.jsxs)(Ue.a,{widths:"equal",children:[Object(r.jsx)(We.a,{value:(null===b||void 0===b||null===(t=b.risk)||void 0===t?void 0:t.toString())||"",options:_(g),label:"Risk",required:!0,onChange:function(e,t){var n=t.value;return j((function(e){return Object(f.a)(Object(f.a)({},e),{},{risk:+n})}))}}),Object(r.jsx)(We.a,{value:(null===b||void 0===b||null===(n=b.priority)||void 0===n?void 0:n.toString())||"",options:_(h),label:"Priority",required:!0,onChange:function(e,t){var n=t.value;return j((function(e){return Object(f.a)(Object(f.a)({},e),{},{priority:+n})}))}})]}),Object(r.jsx)(He.a,{value:(null===b||void 0===b?void 0:b.points)||"",type:"number",label:"Points",required:!0,onChange:function(e,t){var n=t.value;return j((function(e){return Object(f.a)(Object(f.a)({},e),{},{points:+n})}))}})]})})},$e=function(e){var t=e.sprint,n=e.save,i=e.onClose,a=e.remove,s=e.removeDisabled,c=void 0!==(null===t||void 0===t?void 0:t.id),l=Object(o.useState)(),u=Object(p.a)(l,2),d=u[0],b=u[1];return Object(o.useEffect)((function(){t&&b(t)}),[t]),Object(r.jsx)(Ze,{entityName:"sprint",onClose:i,remove:a,editMode:c,save:function(){return n(d)},entity:t,removeDisabled:s,formControls:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(He.a,{label:"Name",value:(null===d||void 0===d?void 0:d.name)||"",required:!0,autoFocus:!0,onChange:function(e,t){var n=t.value;return b((function(e){return Object(f.a)(Object(f.a)({},e),{},{name:n})}))}}),Object(r.jsx)(He.a,{label:"Max story points",value:(null===d||void 0===d?void 0:d.maxPoints)||"",type:"number",required:!0,onChange:function(e,t){var n=t.value;return b((function(e){return Object(f.a)(Object(f.a)({},e),{},{maxPoints:+n})}))}})]})})},Ke=function(){var e,t=Object(T.useSelector)(ae),n=Object(T.useSelector)(se),o=Object(T.useDispatch)();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{editingData:n,save:function(e){return o(G(e))},onClose:function(){return o(oe(void 0))},remove:function(){return o(z(n))}}),Object(r.jsx)($e,{sprint:t,save:function(e){return o(J(e))},onClose:function(){return o(re(void 0))},remove:function(){return o(Q(t))},removeDisabled:(null===t||void 0===t||null===(e=t.stories)||void 0===e?void 0:e.length)&&t.stories.length>0?"Can't delete sprint while it contains stories":void 0})]})},Xe=function(){var e=Object(T.useSelector)(Y),t=Object(T.useSelector)($),n=Object(T.useSelector)(K);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(qe,{stories:e,sprints:t}),Object(r.jsx)(Ke,{}),Object(r.jsx)(fe,{sprints:t,isDragging:n}),Object(r.jsx)(Ae,{stories:e,isDragging:n})]})};var et=function(){var e=Object(T.useDispatch)();return Object(r.jsxs)(k.a,{onDragStart:function(t){e(W(t)),e(B(!0))},onDragEnd:function(t){e(U(t)),e(B(!1))},children:[Object(r.jsx)(he.a,{timeOut:4e3,newestOnTop:!1,position:"top-right",getState:function(e){return e.toastr},transitionIn:"fadeIn",transitionOut:"fadeOut",closeOnToastrClick:!0}),Object(r.jsx)("div",{className:l.a.container,children:Object(r.jsx)(Xe,{})})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(209);s.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(T.Provider,{store:xe,children:Object(r.jsx)(et,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},42:function(e,t,n){e.exports={container:"styles_container__3-8qy",container_overflowed:"styles_container_overflowed__27AT7",header:"styles_header__3ew-f",title:"styles_title__1HS-B",capacity:"styles_capacity__1a39v",capacity_overflowed:"styles_capacity_overflowed__1EpzU",stories_droppable:"styles_stories_droppable__2Dvxb",allowedToDrop:"styles_allowedToDrop__2c5n3",notAllowedToDrop:"styles_notAllowedToDrop__xOeQN"}},46:function(e,t,n){e.exports={container:"styles_container__L6rJV",high:"styles_high__2Lx67",medium:"styles_medium__2eR9O",low:"styles_low__Pgv-b",points_container:"styles_points_container__38J5S",points:"styles_points__QOcRD",name:"styles_name__nB6qQ",priority:"styles_priority__3OgAd"}},95:function(e,t,n){e.exports={container:"styles_container__31L8W",menus:"styles_menus__3-Y6A",stories_droppable:"styles_stories_droppable__equtx",availableToDrop:"styles_availableToDrop__1VkhZ"}}},[[210,1,2]]]);
//# sourceMappingURL=main.03bb2ca2.chunk.js.map